<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Classification</title>
    <meta charset="utf-8" />
    <meta name="author" content="MSc in Data Science and Business Analytics" />
    <meta name="date" content="2025-11-14" />
    <script src="libs/header-attrs-2.30/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="custom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Classification
]
.subtitle[
## Predictive Analytics &amp; Big Data | Lecture 4
]
.author[
### MSc in Data Science and Business Analytics
]
.date[
### November 14, 2025
]

---



---
class: inverse, center, middle

# Lecture 4
# Classification

### "The goal is to turn data into information, and information into insight."
‚Äî Carly Fiorina

---

# Course Roadmap

.pull-left[
**Week 1: Foundations**
- Lecture 1: Regression
- Lecture 2: Advanced Regression
- Lecture 3: Regularization
- **Lecture 4: Classification** ‚Üê *You are here*

**Week 2: Advanced Models**
- Lecture 5: Clustering
- Lecture 6: Recommendation Systems
]

.pull-right[
**Week 3: Advanced Topics**
- Lecture 7: Text Analytics
- Lecture 8: Neural Networks
- Lecture 9: Deep Learning

**Projects**
- Customer segmentation
- Churn prediction
- Recommendation engine
]

---

# Today's Learning Objectives

By the end of this lecture, you will:

1. **Understand** when to use classification vs regression

2. **Build** logistic regression models in R

3. **Evaluate** models with confusion matrices and ROC curves

4. **Interpret** coefficients as odds ratios

5. **Handle** class imbalance in real datasets

6. **Deploy** a classification model for business decisions

---

# Regression vs Classification
&lt;table class="table table-striped table-hover" style="font-size: 16px; width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Aspect &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Regression &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Classification &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 20%; font-weight: bold;"&gt; Output &lt;/td&gt;
   &lt;td style="text-align:left;width: 40%; background-color: rgba(240, 240, 240, 255) !important;"&gt; Continuous number &lt;/td&gt;
   &lt;td style="text-align:left;width: 40%; background-color: rgba(232, 244, 248, 255) !important;"&gt; Category/Class &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 20%; font-weight: bold;"&gt; Example &lt;/td&gt;
   &lt;td style="text-align:left;width: 40%; background-color: rgba(240, 240, 240, 255) !important;"&gt; House price: $450,000 &lt;/td&gt;
   &lt;td style="text-align:left;width: 40%; background-color: rgba(232, 244, 248, 255) !important;"&gt; Customer churn: Yes/No &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 20%; font-weight: bold;"&gt; Algorithm &lt;/td&gt;
   &lt;td style="text-align:left;width: 40%; background-color: rgba(240, 240, 240, 255) !important;"&gt; Linear regression &lt;/td&gt;
   &lt;td style="text-align:left;width: 40%; background-color: rgba(232, 244, 248, 255) !important;"&gt; Logistic regression &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 20%; font-weight: bold;"&gt; Evaluation &lt;/td&gt;
   &lt;td style="text-align:left;width: 40%; background-color: rgba(240, 240, 240, 255) !important;"&gt; RMSE, R¬≤ &lt;/td&gt;
   &lt;td style="text-align:left;width: 40%; background-color: rgba(232, 244, 248, 255) !important;"&gt; Accuracy, AUC &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

**Key difference:** The thing you're predicting!

---

# The Business Problem

**You're a Data Scientist at TelecomCo**

**CEO's Question:**

*"We're losing 500 customers per month. Each costs $5,000 to acquire."*

*"That's $2.5M in losses monthly!"*

*"Can you predict WHO will churn BEFORE they leave?"*

*"Then we can offer retention deals to save them."*

---

# The Stakes

**Current situation:**
- 10,000 active customers
- 5% churn monthly (500 customers)
- Customer acquisition cost: $5,000
- Monthly loss: $2.5M

**Your mission:**
- Predict which customers will churn
- Retention offer costs $200 per customer
- 70% success rate if contacted in time

**ROI calculation:** If you save 350 customers ‚Üí $1.75M saved - $100K cost = **$1.65M monthly profit**

---

# The Data: Customer Records
&lt;table class="table table-striped table-hover" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; ID &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Tenure (mo) &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Monthly ($) &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Support Calls &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Contract &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Churned? &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 55 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 33.65 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Month-to-Month &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 56 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 37.71 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Two Year &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 71.96 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Month-to-Month &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Yes &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 50 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 101.11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Two Year &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 39 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 31.54 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Month-to-Month &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Yes &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 32 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 109.34 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; One Year &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 44 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 77.54 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; One Year &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 34.66 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Month-to-Month &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Yes &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

**What patterns do you notice?**

---

# Quick Exploration
&lt;img src="Lecture1_files/figure-html/unnamed-chunk-3-1.png" style="display: block; margin: auto;" /&gt;

**Insight:** Churned customers have shorter tenure!

---

# Why Not Use Linear Regression?

**Attempt:** Predict churn with linear regression

``` r
# Try linear regression (WRONG!)
bad_model &lt;- lm(churned ~ tenure_months, 
                data = churn_data %&gt;% 
                  mutate(churned = as.numeric(churned_label == "Yes")))
```

**Problem:** Linear regression predicts **any number**

- Could predict 1.5 (impossible!)
- Could predict -0.3 (impossible!)
- We need predictions between 0 and 1

---

# Linear Regression Fails
&lt;img src="Lecture1_files/figure-html/unnamed-chunk-5-1.png" style="display: block; margin: auto;" /&gt;

**We need a different approach!**

---
class: center, middle

# Part 1: Logistic Regression

---

# The Solution: Logistic Function

**Instead of a straight line, use an S-curve (sigmoid)**

`$$P(Churn = Yes) = \frac{1}{1 + e^{-(\beta_0 + \beta_1 X)}}$$`

**Key properties:**
- Output is always between 0 and 1 ‚úì
- Represents probability ‚úì
- Smooth transition ‚úì

---

# Visualizing the Logistic Function
&lt;img src="Lecture1_files/figure-html/unnamed-chunk-6-1.png" style="display: block; margin: auto;" /&gt;

---

# From Linear to Logistic
&lt;img src="Lecture1_files/figure-html/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /&gt;

---

# Building Your First Model in R

**Step 1: Prepare data**

``` r
# Load data
data &lt;- read.csv("telecom_churn.csv")

# Check structure
head(data)
str(data)
```

**Step 2: Fit logistic regression**

``` r
# Use glm() with family = binomial
model &lt;- glm(churned_label ~ tenure_months + monthly_charges + 
               support_calls + contract_type,
             data = churn_data,
             family = binomial)  # This makes it logistic!
```

---

# Understanding the Output

``` r
summary(model)
```

```
## 
## Call:
## glm(formula = churned_label ~ tenure_months + monthly_charges + 
##     support_calls + contract_type, family = binomial, data = churn_data)
## 
## Coefficients:
##                        Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)           -0.554293   0.367269  -1.509    0.131    
## tenure_months         -0.042388   0.006432  -6.591 4.38e-11 ***
## monthly_charges        0.020223   0.003739   5.409 6.34e-08 ***
## support_calls          0.347365   0.077016   4.510 6.47e-06 ***
## contract_typeOne Year -1.545206   0.256632  -6.021 1.73e-09 ***
## contract_typeTwo Year -1.059355   0.267307  -3.963 7.40e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 678.28  on 499  degrees of freedom
## Residual deviance: 544.89  on 494  degrees of freedom
## AIC: 556.89
## 
## Number of Fisher Scoring iterations: 4
```

---

# Interpreting Coefficients
&lt;table class="table table-striped table-hover" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Variable &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Coefficient &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Interpretation &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Tenure (months) &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.05 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Each month ‚Üí 5% lower churn odds &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Monthly Charges &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.02 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Each $1 ‚Üí 2% higher churn odds &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Support Calls &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.30 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Each call ‚Üí 30% higher churn odds &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

**Remember:** Negative coefficient = reduces churn probability

---

# Making Predictions

``` r
# Predict probabilities for new customers
new_customers &lt;- tibble(
  tenure_months = c(3, 24, 48),
  monthly_charges = c(80, 60, 45),
  support_calls = c(5, 1, 0),
  contract_type = c("Month-to-Month", "One Year", "Two Year")
)

# Get predictions
predictions &lt;- predict(model, new_customers, type = "response")
new_customers$churn_prob &lt;- round(predictions, 3)
```

---

# Prediction Results
&lt;table class="table table-striped table-hover" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; Tenure &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Monthly $ &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Calls &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Contract &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Churn Prob &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;background-color: rgba(255, 235, 238, 255) !important;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:right;background-color: rgba(255, 235, 238, 255) !important;"&gt; 80 &lt;/td&gt;
   &lt;td style="text-align:right;background-color: rgba(255, 235, 238, 255) !important;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:left;background-color: rgba(255, 235, 238, 255) !important;"&gt; Month-to-Month &lt;/td&gt;
   &lt;td style="text-align:right;background-color: rgba(255, 235, 238, 255) !important;"&gt; 0.935 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 24 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 60 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; One Year &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.174 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;background-color: rgba(232, 245, 233, 255) !important;"&gt; 48 &lt;/td&gt;
   &lt;td style="text-align:right;background-color: rgba(232, 245, 233, 255) !important;"&gt; 45 &lt;/td&gt;
   &lt;td style="text-align:right;background-color: rgba(232, 245, 233, 255) !important;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:left;background-color: rgba(232, 245, 233, 255) !important;"&gt; Two Year &lt;/td&gt;
   &lt;td style="text-align:right;background-color: rgba(232, 245, 233, 255) !important;"&gt; 0.061 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

**Decision rule:** If probability &gt; 0.5 ‚Üí Predict "Will Churn"

---

# The Threshold Question

**Should we always use 0.5 as the threshold?**
&lt;img src="Lecture1_files/figure-html/unnamed-chunk-14-1.png" style="display: block; margin: auto;" /&gt;

**It depends on business costs!**

---

# Converting Probabilities to Classes

``` r
# Use 0.5 threshold
predictions_binary &lt;- ifelse(predictions &gt; 0.5, "Yes", "No")

# Show results
results &lt;- new_customers %&gt;%
  mutate(prediction = predictions_binary)

print(results)
```

```
## # A tibble: 3 √ó 6
##   tenure_months monthly_charges support_calls contract_type  churn_prob
##           &lt;dbl&gt;           &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;
## 1             3              80             5 Month-to-Month      0.935
## 2            24              60             1 One Year            0.174
## 3            48              45             0 Two Year            0.061
## # ‚Ñπ 1 more variable: prediction &lt;chr&gt;
```

**Next:** How do we measure if these predictions are good?

---
class: center, middle

# Part 2: Model Evaluation

---

# The Confusion Matrix

**Actual vs Predicted outcomes**
&lt;table class="table table-striped table-hover" style="font-size: 18px; width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
&lt;tr&gt;
&lt;th style="empty-cells: hide;border-bottom:hidden;" colspan="1"&gt;&lt;/th&gt;
&lt;th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;Predicted&lt;/div&gt;&lt;/th&gt;
&lt;/tr&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Actual &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; No &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Yes &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;background-color: rgba(236, 240, 241, 255) !important;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 233 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 60 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;background-color: rgba(236, 240, 241, 255) !important;"&gt; Yes &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 80 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 127 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# Understanding the Matrix
&lt;table class="table table-striped table-hover" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Cell &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Meaning &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Count &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; True Negative (TN) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Correctly predicted No churn &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 233 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; False Positive (FP) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Predicted churn, but stayed (wasted offer) &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 60 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;background-color: rgba(255, 235, 238, 255) !important;"&gt; False Negative (FN) &lt;/td&gt;
   &lt;td style="text-align:left;background-color: rgba(255, 235, 238, 255) !important;"&gt; Predicted stay, but churned (EXPENSIVE!) &lt;/td&gt;
   &lt;td style="text-align:right;background-color: rgba(255, 235, 238, 255) !important;"&gt; 80 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; True Positive (TP) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Correctly predicted churn &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 127 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

**False Negatives hurt most:** We miss customers who will churn!

---

# Key Metrics

``` r
# Calculate metrics
TP &lt;- cm[2,2]  # True Positives
TN &lt;- cm[1,1]  # True Negatives
FP &lt;- cm[1,2]  # False Positives
FN &lt;- cm[2,1]  # False Negatives

# Accuracy: Overall correctness
accuracy &lt;- (TP + TN) / sum(cm)

# Precision: Of predicted churns, how many actually churned?
precision &lt;- TP / (TP + FP)

# Recall (Sensitivity): Of actual churns, how many did we catch?
recall &lt;- TP / (TP + FN)

# F1 Score: Balance of precision and recall
f1 &lt;- 2 * (precision * recall) / (precision + recall)
```

---

# Metrics Visualized
&lt;img src="Lecture1_files/figure-html/unnamed-chunk-19-1.png" style="display: block; margin: auto;" /&gt;

---

# Business Translation
&lt;table class="table table-striped table-hover" style="font-size: 13px; width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Metric &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Technical Meaning &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Business Translation &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Our Score &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Accuracy &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; % of all predictions correct &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; How often we're right overall &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: rgba(39, 174, 96, 255) !important;"&gt; 72% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Precision &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; % of predicted churns that are real &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; How much we waste on wrong alerts &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: rgba(39, 174, 96, 255) !important;"&gt; 67.9% &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;font-weight: bold;"&gt; Recall &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; % of actual churns we identified &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; How many churners we save &lt;/td&gt;
   &lt;td style="text-align:left;font-weight: bold;color: rgba(39, 174, 96, 255) !important;"&gt; 61.4% &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

**Which metric matters most? Depends on business costs!**

---

# Next Up: Advanced Evaluation

In the next part of slides, we'll cover:

1. **ROC Curves** - Visualizing performance across all thresholds
2. **AUC Score** - Single number to compare models
3. **Threshold Optimization** - Finding the best cutoff for your business
4. **Class Imbalance** - Handling rare events (only 5% churn)
5. **Model Deployment** - Putting it into production

---

# üéØ Quick Practice

**Open your R console and try:**

``` r
# 1. Load the data
data &lt;- read.csv("churn_data.csv")

# 2. Fit a simple model
model &lt;- glm(churned ~ tenure_months + monthly_charges,
             data = data,
             family = binomial)

# 3. Check the summary
summary(model)

# 4. Make predictions
data$prob &lt;- predict(model, type = "response")
data$predicted &lt;- ifelse(data$prob &gt; 0.5, "Yes", "No")

# 5. Create confusion matrix
table(Actual = data$churned, Predicted = data$predicted)
```

---

# Summary: 

**What we've learned:**

‚úÖ Difference between regression and classification

‚úÖ Why linear regression fails for classification

‚úÖ How logistic regression works (sigmoid function)

‚úÖ Building models with `glm()` in R

‚úÖ Interpreting coefficients

‚úÖ Making predictions

‚úÖ Confusion matrix

‚úÖ Key metrics: accuracy, precision, recall, F1

**Next part:** Advanced evaluation and deployment!

---


---

# When to Retrain

**Retrain your model when:**

1. **Performance degrades:** AUC drops below threshold (e.g., 0.75)

2. **Data drift detected:** Customer behavior changes significantly

3. **New features available:** Additional data sources added

4. **Business changes:** New products, pricing, or policies

5. **Regular schedule:** Monthly or quarterly regardless of performance

**Best practice:** Automated retraining pipeline with human approval

---

# Summary: 

**What we've learned:**

‚úÖ ROC curves visualize performance across all thresholds

‚úÖ AUC provides single score for model comparison

‚úÖ Optimal threshold depends on business costs

‚úÖ Class imbalance requires special handling (weights, SMOTE, threshold adjustment)

‚úÖ Odds ratios make coefficients interpretable

‚úÖ Model monitoring prevents performance degradation

**Next:** More advanced classifiers and multi-class problems!

---
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
  "highlightStyle": "github",
  "highlightLines": true,
  "countIncrementalSlides": false,
  "ratio": "16:9",
  "slideNumberFormat": "Slide %current%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
